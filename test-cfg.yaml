#-------------------------------------------------------------------------------
#
# SDK Jenkins Pipeline Configuration
#
# Copyright (C) 2022, HENSOLDT Cyber GmbH
#
#-------------------------------------------------------------------------------

# General YAML Format
#
# "something: [foo]" is the same as "something: foo".
# "something: [foo, bar]" is the same as
#
#    something:
#    - foo
#    - bar
#
# Format for test configurations:
#
# - <system name>
#   - flags: [BUILD, TEST, SDK_DEMO]
#   - testSystem: <repo>
#   - testScript: <name, defaults to <system name>.py >
#   - useTest: <system name>
#   - buildParams:
#     - target: tcp_server   -> "-D TEST_CONFIGURATION=<target>"
#   - testParams:
#     - target: tcp_server   -> "--tc=platform.test_configuration:<target>"
#   - platforms:
#     - <name1>
#     - <name2>
#       - addFlags: [BUILD, TEST, SDK_DEMO]


#-------------------------------------------------------------------------------
# Fundamental Demo Systems, required for the SDK package sanity check
#-------------------------------------------------------------------------------

- demo_hello_world:
  - flags: [BUILD, SDK_DEMO]
  - testScript: test_demo_hello_world.py
  - platforms:
    - zynq7000:
      - addFlags: TEST
    - sabre:
      - addFlags: TEST
    - spike64:
      - addFlags: TEST
    - qemu-arm-virt-a15:
      - addFlags: TEST
    - qemu-arm-virt-a53:
      - addFlags: TEST
    - odroidc2
    - jetson-tx1-dev-kit
    - jetson-nano-2gb-dev-kit


#-------------------------------------------------------------------------------
# Unofficial Demo Systems
#-------------------------------------------------------------------------------

- demo_vm_minimal:
  - flags: [BUILD]
  - testScript: test_demo_vm_minimal.py
  - platforms:
    - qemu-arm-virt-a15:
      - addFlags: TEST
    - qemu-arm-virt-a53:
      - addFlags: TEST
    - odroidc2

- demo_vm_serialserver:
  - flags: [BUILD]
  - testScript: test_demo_vm_serialserver.py
  - platforms:
    - qemu-arm-virt-a53:
      - addFlags: TEST
  - odroidc2

- demo_vm_virtio_net:
  - flags: [BUILD]
  - testScript: test_demo_vm_virtio_net.py
  - platforms:
    - qemu-arm-virt-a53:
      - addFlags: TEST
    - odroidc2

- demo-mavlink-testapp:
  - flags: [BUILD]
  - testScript: test_demo_mavlink-testapp.py
  - platforms:
    - qemu-arm-virt-a53:
      - addFlags: TEST
    - odroidc2


#------------------------------------------------------------------------------
# Test Systems
#
# Testing ZynqMP requires using the test container trentos_test:20210316
# which contains the Xilinx QEMU.
#------------------------------------------------------------------------------

- test_timeserver:
  - flags: [BUILD]
  - platforms:
    - qemu-arm-virt-a53:
      - addFlags: TEST
    - odroidc2
    - jetson-tx1-dev-kit
    - jetson-nano-2gb-dev-kit
